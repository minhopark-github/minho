교육 제목: 파이썬 머신러닝 파이썬 데이터분석

교육 일시: 21.09.30

교육 장소: 비대면



# # 데이터 살펴보기, 판다스 시각화 도구

## 1. 데이터 살펴보기

### 1-1.데이터프레임의 구조

#### a. 데이터 내용 미리보기

df.head()와 df.tail()를 활용한다. 데이터 일부의 형과 값을 간단히 확인할 때. 데이터가 클 때 의미가 있다.

#### b. 데이터 요약 정보 확인하기

b-1 df.shape()은 데이터프레임의 행의 개수, 열의 개수를 확인하여 (#행,#열)로 튜플로 반환한다.  (axis=0,axis=1)이기에 데이터프레임의 dimension은 len(df.shape())으로 구해질 수 있다. 이 경우엔 2차원. 행 개수와 열 개수를 파악하면 아무래도 범주가 될 축과 데이터가 될 축을 어림짐작할 수 있다.

b-2 df.info()는 데이터프레임의 기본 정보를 화면에 출력하는데, 클래스 유형, 행 인덱스의 구성, 열 이름의 종류와 개수, 각 열의 자료형과 개수, 메모리 할당량에 관한 정보가 포함된다. 앞에서 shape으로는 크기에 관한 정보를 봤다면 거기에 더해 구성물에 대한 정보까지 나오는 셈이다.

b-3  df.describe()는 산술 데이터를 갖는 열에 대한 주요 기술 통계 정보(평균 표준편차 최대최소 중간값 등)를 준다. 산술 데이터가 아닌 열에 대한 정보를 포함하고 싶을 떄는 include=all 옵션을 추가한다. 문자열 데이터에는 고유값 개수, 최빈값, 빈도수와 같은 문자형 데이터도 가질 수 있는 통계값이 나온다.

b-4 df.count()는 각 열에 해당하는 데이터값이 몇개나 있는지 세는, 즉 각 열의 길이를 재는 것으로, 정보 자체는 info에서도 제공하지만 이것이 데이터형으로 반환되어 조금 더 다루기 쉽다.

b-5 고유값은 .value_count()로 확인 가능하며, 도수분포표가 만들어진다고 보면 된다.





### 1-2. 통계 함수 적용

평균값 중간값 최대값 최소값 표준편차 상관계수는 df에 적용하면 각 열에 해당하는 모든 값을 구해 반환하며, 각 열에 따로따로 적용할수도 있다.

### 1-3. 판다스 내장 그래프 도구 활용

matplotlib 라이브러리를 내장하고 있어서 몇가지 간단한 그래프를 손쉽게 그릴 수 있다.

axis=0과 axis=1, 그리고 값이 의미하는 바를 알면 이해가 쉽다.

row축은 수학에서 x축 역할을 하며, axis=1은 헤더가 있다면 그것이 함수의 이름, f 역할을 한다. 그리고 값이 함수값, f(x)가 된다.

예컨대 각 열의 이름은 f, g, h, k, 등 함수명이 되는 셈이다.

각 행과 열에 이름이 없다면 그냥 데이터만으로도 plot이 되는데, 그것도 이 연장선에서 이해 가능하다.

선, 수직 막대, 수평 막대, 히스토그램, 박스, 커널 밀도, 면적, 파이, 산점도, 고밀도 산점도 등 여러 종류의 데이터에 대해 출력할 수 있다.

## 2. 판다스 시각화 도구

크게 보면 1-3과 크게 다르지 않으며, 이런 툴이 있다고 소개하며 필요할 떄 가져다 쓸 수 있으면 되는 정도이다,

### 2-1. Matplotlib = 수학함수라이브러리 : 기본 그래프 도구

사실 이번 장에서 가장 중요한 데이터를 따오는 전처리 부분이 있다. 그 외는 그 데이터를 가지고 툴을 활용하는 셈이다.

데이터 전처리를 하지 않으면 다른 과정에서 문제가 생길 가능성이 높아진다. NaN이 없게 해주자.

누락값 NaN을 제거하는 방법으로,  fillna()메소드를 사용하여  method='ffill'옵션을 사용한다.

이후 필요한 데이터 부분을 선별하는 작업이 필요한데, 핵심은 df[bool]로도 데이터가 뽑힌다는 사실 그 자체고, 그를 이용해서 조건문을 안에 넣어주면 해당 조건에 맞는 데이터를 뽑아낼 수 있게 된다.

책의 예시는 이렇다. 

(df['전출지별']=='서울특별시') & (df['전입지별']!='서울특별시')

전출지별 열에 해당하는 서울특별시를 고르고, 전입지별에 해당하는 서울특별시를 제거하는 불리언으로, 이걸 df에 넣어 해당 데이터를 얻어냈다.



이후의 그래프는 이런 데이터를 얻는다는 전제로 이야기된다. 그러니 이걸 못하면 문제가 커진다.

영어로 그래프를 만들면 별 상관 없지만, 부득이 한글을 사용해야 할 때는 폰트 오류 해결을 위해 폰트를 추가해야한다.

선 그래프를 기본형으로 설명하는데, 축에 이름을 붙이거나 그래프에 이름을 붙이거나그래프 제목을 붙이고 거기에 화살표를 얹는다던지 각도를 조절한다던지 하는 여러가지 툴을 코딩으로 구현할 수 있다. 또한 비교를 위해 한 figure에 여러 그래프를 넣는다던지 같은 범주 안에 여러 그래프를 표기한다던지 면적 그래프로 겹쳐보인다던지 하는 방식까지 구현된다.

막대그래프도 그릴 수 있는데, 선형 그래프와 합쳐  표기할 수도 있다. 산점도는 분포하는 점의 크기를 표현할 수 있고, 색상으로 추가적인 정보를 더 줄 수도 있다. 다른 일반적인 통계 그래프로는 간단한 박스플롯이 가능하다.

 

### 2-2. Seaborn 라이브러리: 고급 그래프 도구

seaborn 라이브러리는 조금 더 세부적인 옵션을 조절할 수 있는 그래프 도구인데, 예컨대 산점도에는 선형회귀분석에 의한 회귀선을 추가할 수 있고, 히스토그램/커널에는 밀도를 추가하여 얼마나 빽빽한지 숫자로 쉽게 파악하 수 있다.또한 데이터의 도수를 색으로 표현하여 나타내는 히트맵도 만들 수 있다. github의 잔디밭처럼. 그리고 선형출력은 한 막대에 여러 범주를 넣을수도 있으며, 그걸 선형으로, 혹은 누적형으로 표현이 가능하다. 박스플롯만 가능했던 파이썬 기본 함수와는 달리 바이올린 그래프도 출력이 가능하며, 적당한 그리드로 나눠 가독성을 높일 수도 있다.

 

### 2-3. Folium 라이브러리: 지도 활용

folium 라이브러리는 지도 위에 뭔가를 표기할 떄 매우 유용하다. 코로나 초창기에 코로나맵이라는 웹이 꽤나 유명했는데, 그런 웹도 이런 지도데이터를 기반으로 만든 것이다. 지도의 스타일과 구분 구역, 마커 표시, 데이터에 따른 색깔 단계 구분 등 지도로 할 수 있는 기본적인 툴이 제공된다.



